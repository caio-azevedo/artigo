select(mun,x11)
# Juntando a base existente
dados<-full_join(dados, dom, c("mun"))
rm(dom)
#IDHM----
idhm<- read_xlsx("data/atlas2013_dadosbrutos_pt.xlsx",
sheet = "MUN 91-00-10")
idhm<-idhm %>%
filter(ANO==2010,UF==33) %>%
select(Município,IDHM) %>%
rename("x12"=IDHM)
MUN<-paste(idhm$Município, "(RJ)", sep=" ")
idhm<-cbind(MUN,idhm)
idhm<-idhm[,-2]
rm(MUN)
# Juntando a base existente ----
MUN<-toupper(dados$mun)
dados<-cbind(MUN,dados)
dados<-full_join(dados, idhm, c("MUN"))
dados<-dados %>%
select(-MUN)
rm(idhm)
#PIB per capita----
pib_per<-full_join(pib,pop,c("mun"))
pib_per<-pib_per %>%
mutate(pib=as.numeric(pib)) %>%
mutate(pop=as.numeric(pop)) %>%
mutate(x13=pib/pop) %>%
select(-pib,-pop)
# Juntando a base existente
dados<-full_join(dados, pib_per, c("mun"))
rm(pib_per,pib,pop)
# Pessoas ocupadas na indústria----
ind<-ocup %>%
mutate(x14=(transf+extrat)/total) %>%
select(mun,x14)
# Juntando a base existente
dados<-full_join(dados, ind, c("mun"))
rm(ind,ocup)
#Domicilios com microcomputador e internet----
comp<- read_xlsx("data/tabela2249.xlsx",
col_names = c("mun","total", "pc"),
skip=5, n_max = 92)
comp<-comp %>%
mutate(x15=pc/total) %>%
select(mun,x15)
# Juntando a base existente
dados<-full_join(dados, comp, c("mun"))
rm(comp)
#Domicilios com rendimento de 10 a 20 salarios----
rend10<- read_xlsx("data/tabela3571.xlsx",
col_names = c("mun","total", "rend"),
skip=6, n_max = 92)
rend10<-rend10 %>%
mutate(x16=rend/total) %>%
select(mun,x16)
# Juntando a base existente
dados<-full_join(dados, rend10, c("mun"))
rm(rend10)
#Domicilios tipo apartamento----
apart<- read_xlsx("data/tabela3513.xlsx",
col_names = c("mun","tipo", "exist", "total", "apartamento"),
skip=7, na="-", n_max = 92)
apart<-apart %>%
select(-"tipo",-"exist") %>%
mutate(x17=apartamento/total) %>%
select(mun,x17)
# Juntando a base existente
dados<-full_join(dados, apart, c("mun"))
rm(apart)
# Bolsa família----
bolsa_fam<- read.csv("data/visdata3-download-05-03-2021 143251.csv",sep = ",",
col.names = c("cod","mun","uf","ref","qtd"))
# Inserindo (RJ) para junção das tabelas
MUN<-paste(bolsa_fam$mun, "(RJ)", sep=" ")
bolsa_fam<-cbind(MUN,bolsa_fam)
bolsa_fam<-bolsa_fam %>%
select("MUN","qtd") %>%
rename(x18=qtd)
#Adicionando domicílios
dom<- read_xlsx("data/tabela1134.xlsx",
col_names = c("mun","tot1", "tot2", "tot3", "domicilios"),
skip=7, n_max = 92)
dom<-dom %>%
select(mun,domicilios)
rm(MUN)
# Juntando a base existente
MUN<-toupper(dom$mun)
dom<-cbind(MUN,dom)
bolsa_fam<-full_join(dom, bolsa_fam, c("MUN"))
bolsa_fam<-bolsa_fam %>%
mutate(x18=x18/domicilios) %>%
select(-"MUN",-"domicilios")
rm(MUN,dom)
# Juntando a base existente
dados<-full_join(dados, bolsa_fam, c("mun"))
rm(bolsa_fam)
View(dados)
write.table(dados,file='data/base.csv',sep=';', row.names = F)
write.table(dados,file='data/base_excel.xlsx',sep=';', row.names = F)
dados<- replace(dados, list = is.na(dados), values = 0)
write.table(dados,file='data/base.csv',sep=';', row.names = F)
write.table(dados,file='data/base_excel.xlsx',sep=';', row.names = F)
# Carregando pacotes a serem utilizados
library(dplyr)
library(corrplot)
library(psych)
library(xtable)
library(sjmisc) #Rotação data frame
# Limpar----
rm(list=ls())
#Diretório
setwd("c:/Users/CAIO AZEVEDO/Documents/Documentos Caio/Github/Monografia")
# Importando os dados disponíveis no GitHub
#site<-"https://raw.githubusercontent.com/caio-azevedo/Monografia/master/data/base.csv"
dados<- read.table("data/base.csv", header=T, sep=";")
View(dados)
write_spss(dados, "meu_banco.sav")
library(sjmisc)
write_spss(dados, "meu_banco.sav")
library(sjmisc)
devtools::install_github("strengejacke/strengejacke")
install.packages("dplyr")
library(dplyr)
library(readxl)
library(stringr)
library(sjmisc)
install.packages("sjlabelled")
library(sjlabelled)
write_spss(dados, "meu_banco.sav")
# Carregando pacotes a serem utilizados
library(dplyr)
library(corrplot)
library(psych)
library(xtable)
library(sjmisc) #Rotação data frame
# Limpar----
rm(list=ls())
#Diretório
setwd("c:/Users/CAIO AZEVEDO/Documents/Documentos Caio/Github/Monografia")
# Importando os dados disponíveis no GitHub
#site<-"https://raw.githubusercontent.com/caio-azevedo/Monografia/master/data/base.csv"
dados<- read.table("data/base.csv", header=T, sep=";")
# Preparação dos dados
dados<-dados %>%
select(mun,x1, x2,x4, x5, x7, x8, x9,x12, x13, x15, x16, x17, x18)
df<-as.matrix(dados[,2:14])
row.names(df)<-dados$Municipio
df<-scale(df)
# Matriz de correlação
matcor<-cor(df)
corrplot(matcor, method="circle")
dev.copy(pdf,"Figuras/matriz_cor.pdf")
dev.off()
# Teste de Bartlett
cortest.bartlett(df)
kmo<-KMO(df)
tab_kmo<-kmo$MSAi
tab1<-rotate_df(data.frame(tab_kmo), rn = c("Variável"))
tab1[1]<-"KMO"
# Variância Explicada
tab2<-summary(princomp(df,cor=TRUE))
tab2<-data.frame(tab2[["sdev"]],
row.names = c(1:11))
colnames(tab2)<-c("Desvio Padrão")
tab2<-tab2 %>%
mutate("Variância"=`Desvio Padrão`^2) %>%
mutate("Proporção"= Variância/sum(Variância))%>%
mutate("Acumulada"=cumsum(Proporção)) %>%
select(-"Desvio Padrão")
# Carregando pacotes a serem utilizados
library(dplyr)
library(corrplot)
library(psych)
library(xtable)
library(sjmisc) #Rotação data frame
# Limpar----
rm(list=ls())
#Diretório
setwd("c:/Users/CAIO AZEVEDO/Documents/Documentos Caio/Github/Monografia")
# Importando os dados disponíveis no GitHub
#site<-"https://raw.githubusercontent.com/caio-azevedo/Monografia/master/data/base.csv"
dados<- read.table("data/base.csv", header=T, sep=";")
# Preparação dos dados
dados<-dados %>%
select(mun,x1, x2,x4, x5, x7, x8, x9,x12, x13, x15, x16, x17, x18)
df<-as.matrix(dados[,2:14])
row.names(df)<-dados$Municipio
df<-scale(df)
# Matriz de correlação
matcor<-cor(df)
corrplot(matcor, method="circle")
dev.copy(pdf,"Figuras/matriz_cor.pdf")
dev.off()
# Teste de Bartlett
cortest.bartlett(df)
# KMO
kmo<-KMO(df)
tab_kmo<-kmo$MSAi
tab1<-rotate_df(data.frame(tab_kmo), rn = c("Variável"))
tab1[1]<-"KMO"
# Variância Explicada
tab2<-summary(princomp(df,cor=TRUE))
tab2<-data.frame(tab2[["sdev"]],
row.names = c(1:13))
colnames(tab2)<-c("Desvio Padrão")
tab2<-tab2 %>%
mutate("Variância"=`Desvio Padrão`^2) %>%
mutate("Proporção"= Variância/sum(Variância))%>%
mutate("Acumulada"=cumsum(Proporção)) %>%
select(-"Desvio Padrão")
var_tab2<-tab2$Variância
plot(var_tab2, lty=1, type="l",xlab = "Fator", ylab = "Variância",
pch=19, col="blue",xlim = c(1,8), lwd=2, bty="l")
abline(h = 1, col = "black", lty=2)
points(var_tab2,pch=18, cex=1.5)
dev.copy(pdf,"Figuras/screeplot.pdf")
dev.off()
PCAvarimax<-principal(df, nfactors=3,
n.obs=92,rotate="varimax",scores=TRUE)
tab<-rotate_df(data.frame(PCAvarimax[["communality"]]), rn = c("Variável"))
tab[1]<-"Comunalidade"
# Diagrama
fa.diagram(PCAvarimax, main = "")
dev.copy(pdf,"Figuras/componentes.pdf")
dev.off()
bartlett<-factor.scores(df,PCAvarimax,
method = c("Bartlett"))
prev<-data.frame(bartlett[["scores"]])
write.table(prev,file='data/base_fatorial.csv',sep=';',na="",
quote=TRUE, row.names=TRUE, col.names = TRUE )
# Carregando pacotes a serem utilizados
library(dplyr)
library(corrplot)
library(psych)
library(xtable)
library(sjmisc) #Rotação data frame
# Limpar----
rm(list=ls())
#Diretório
setwd("c:/Users/CAIO AZEVEDO/Documents/Documentos Caio/Github/Monografia")
# Importando os dados disponíveis no GitHub
#site<-"https://raw.githubusercontent.com/caio-azevedo/Monografia/master/data/base.csv"
dados<- read.table("data/base.csv", header=T, sep=";")
# Preparação dos dados
dados<-dados %>%
select(mun,x2, x3,x4, x5, x7, x8, x9,x12, x13, x15, x16, x17, x18)
df<-as.matrix(dados[,2:14])
row.names(df)<-dados$Municipio
df<-scale(df)
# Matriz de correlação
matcor<-cor(df)
corrplot(matcor, method="circle")
dev.copy(pdf,"Figuras/matriz_cor.pdf")
dev.off()
# Teste de Bartlett
cortest.bartlett(df)
# KMO
kmo<-KMO(df)
tab_kmo<-kmo$MSAi
tab1<-rotate_df(data.frame(tab_kmo), rn = c("Variável"))
tab1[1]<-"KMO"
# Variância Explicada
tab2<-summary(princomp(df,cor=TRUE))
tab2<-data.frame(tab2[["sdev"]],
row.names = c(1:13))
colnames(tab2)<-c("Desvio Padrão")
tab2<-tab2 %>%
mutate("Variância"=`Desvio Padrão`^2) %>%
mutate("Proporção"= Variância/sum(Variância))%>%
mutate("Acumulada"=cumsum(Proporção)) %>%
select(-"Desvio Padrão")
# Screeplot
var_tab2<-tab2$Variância
plot(var_tab2, lty=1, type="l",xlab = "Fator", ylab = "Variância",
pch=19, col="blue",xlim = c(1,8), lwd=2, bty="l")
abline(h = 1, col = "black", lty=2)
points(var_tab2,pch=18, cex=1.5)
dev.copy(pdf,"Figuras/screeplot.pdf")
dev.off()
# Rotação
PCAvarimax<-principal(df, nfactors=3,
n.obs=92,rotate="varimax",scores=TRUE)
# Comunalidades
tab<-rotate_df(data.frame(PCAvarimax[["communality"]]), rn = c("Variável"))
tab[1]<-"Comunalidade"
# Diagrama
fa.diagram(PCAvarimax, main = "")
dev.copy(pdf,"Figuras/componentes.pdf")
dev.off()
bartlett<-factor.scores(df,PCAvarimax,
method = c("Bartlett"))
prev<-data.frame(bartlett[["scores"]])
# Exportando os resultados
write.table(prev,file='data/base_fatorial.csv',sep=';',na="",
quote=TRUE, row.names=TRUE, col.names = TRUE )
# Carregando pacotes a serem utilizados
library(dplyr)
library(corrplot)
library(psych)
library(xtable)
library(sjmisc) #Rotação data frame
# Limpar----
rm(list=ls())
#Diretório
setwd("c:/Users/CAIO AZEVEDO/Documents/Documentos Caio/Github/Monografia")
# Importando os dados disponíveis no GitHub
#site<-"https://raw.githubusercontent.com/caio-azevedo/Monografia/master/data/base.csv"
dados<- read.table("data/base.csv", header=T, sep=";")
# Preparação dos dados
dados<-dados %>%
select(mun,x1, x3,x4, x5, x7, x8, x9,x12, x13, x15, x16, x17, x18)
df<-as.matrix(dados[,2:14])
row.names(df)<-dados$Municipio
df<-scale(df)
# Matriz de correlação
matcor<-cor(df)
corrplot(matcor, method="circle")
dev.copy(pdf,"Figuras/matriz_cor.pdf")
dev.off()
# Teste de Bartlett
cortest.bartlett(df)
# KMO
kmo<-KMO(df)
tab_kmo<-kmo$MSAi
tab1<-rotate_df(data.frame(tab_kmo), rn = c("Variável"))
tab1[1]<-"KMO"
# Variância Explicada
tab2<-summary(princomp(df,cor=TRUE))
tab2<-data.frame(tab2[["sdev"]],
row.names = c(1:13))
colnames(tab2)<-c("Desvio Padrão")
tab2<-tab2 %>%
mutate("Variância"=`Desvio Padrão`^2) %>%
mutate("Proporção"= Variância/sum(Variância))%>%
mutate("Acumulada"=cumsum(Proporção)) %>%
select(-"Desvio Padrão")
# Screeplot
var_tab2<-tab2$Variância
plot(var_tab2, lty=1, type="l",xlab = "Fator", ylab = "Variância",
pch=19, col="blue",xlim = c(1,8), lwd=2, bty="l")
abline(h = 1, col = "black", lty=2)
points(var_tab2,pch=18, cex=1.5)
dev.copy(pdf,"Figuras/screeplot.pdf")
dev.off()
# Rotação
PCAvarimax<-principal(df, nfactors=3,
n.obs=92,rotate="varimax",scores=TRUE)
# Comunalidades
tab<-rotate_df(data.frame(PCAvarimax[["communality"]]), rn = c("Variável"))
tab[1]<-"Comunalidade"
# Diagrama
fa.diagram(PCAvarimax, main = "")
dev.copy(pdf,"Figuras/componentes.pdf")
dev.off()
bartlett<-factor.scores(df,PCAvarimax,
method = c("Bartlett"))
prev<-data.frame(bartlett[["scores"]])
# Exportando os resultados
write.table(prev,file='data/base_fatorial.csv',sep=';',na="",
quote=TRUE, row.names=TRUE, col.names = TRUE )
# Carregando pacotes a serem utilizados
library(dplyr)
library(corrplot)
library(psych)
library(xtable)
library(sjmisc) #Rotação data frame
# Limpar----
rm(list=ls())
#Diretório
setwd("c:/Users/CAIO AZEVEDO/Documents/Documentos Caio/Github/Monografia")
# Importando os dados disponíveis no GitHub
#site<-"https://raw.githubusercontent.com/caio-azevedo/Monografia/master/data/base.csv"
dados<- read.table("data/base.csv", header=T, sep=";")
# Preparação dos dados
dados<-dados %>%
select(mun,x1, x2,x4, x5, x7, x8, x9,x12, x13, x15, x16, x17, x18)
df<-as.matrix(dados[,2:14])
row.names(df)<-dados$Municipio
df<-scale(df)
# Matriz de correlação
matcor<-cor(df)
corrplot(matcor, method="circle")
dev.copy(pdf,"Figuras/matriz_cor.pdf")
dev.off()
# Teste de Bartlett
cortest.bartlett(df)
# KMO
kmo<-KMO(df)
tab_kmo<-kmo$MSAi
tab1<-rotate_df(data.frame(tab_kmo), rn = c("Variável"))
tab1[1]<-"KMO"
# Variância Explicada
tab2<-summary(princomp(df,cor=TRUE))
tab2<-data.frame(tab2[["sdev"]],
row.names = c(1:13))
colnames(tab2)<-c("Desvio Padrão")
tab2<-tab2 %>%
mutate("Variância"=`Desvio Padrão`^2) %>%
mutate("Proporção"= Variância/sum(Variância))%>%
mutate("Acumulada"=cumsum(Proporção)) %>%
select(-"Desvio Padrão")
# Screeplot
var_tab2<-tab2$Variância
plot(var_tab2, lty=1, type="l",xlab = "Fator", ylab = "Variância",
pch=19, col="blue",xlim = c(1,8), lwd=2, bty="l")
abline(h = 1, col = "black", lty=2)
points(var_tab2,pch=18, cex=1.5)
dev.copy(pdf,"Figuras/screeplot.pdf")
dev.off()
# Rotação
PCAvarimax<-principal(df, nfactors=3,
n.obs=92,rotate="varimax",scores=TRUE)
# Comunalidades
tab<-rotate_df(data.frame(PCAvarimax[["communality"]]), rn = c("Variável"))
tab[1]<-"Comunalidade"
# Diagrama
fa.diagram(PCAvarimax, main = "")
dev.copy(pdf,"Figuras/componentes.pdf")
dev.off()
bartlett<-factor.scores(df,PCAvarimax,
method = c("Bartlett"))
prev<-data.frame(bartlett[["scores"]])
# Exportando os resultados
write.table(prev,file='data/base_fatorial.csv',sep=';',na="",
quote=TRUE, row.names=TRUE, col.names = TRUE )
# Carregando pacotes a serem utilizados
library(dplyr)
library(corrplot)
library(psych)
library(xtable)
library(sjmisc) #Rotação data frame
# Limpar----
rm(list=ls())
#Diretório
setwd("c:/Users/CAIO AZEVEDO/Documents/Documentos Caio/Github/Monografia")
# Importando os dados disponíveis no GitHub
#site<-"https://raw.githubusercontent.com/caio-azevedo/Monografia/master/data/base.csv"
dados<- read.table("data/base.csv", header=T, sep=";")
# Preparação dos dados
dados<-dados %>%
select(mun,x1, x2,x4, x5, x7, x8, x9,x12, x13, x15, x16, x17, x18)
df<-as.matrix(dados[,2:14])
row.names(df)<-dados$Municipio
df<-scale(df)
# Matriz de correlação
matcor<-cor(df)
corrplot(matcor, method="circle")
dev.copy(pdf,"Figuras/matriz_cor.pdf")
dev.off()
# Teste de Bartlett
cortest.bartlett(df)
# KMO
kmo<-KMO(df)
tab_kmo<-kmo$MSAi
tab1<-rotate_df(data.frame(tab_kmo), rn = c("Variável"))
tab1[1]<-"KMO"
# Variância Explicada
tab2<-summary(princomp(df,cor=TRUE))
tab2<-data.frame(tab2[["sdev"]],
row.names = c(1:13))
colnames(tab2)<-c("Desvio Padrão")
tab2<-tab2 %>%
mutate("Variância"=`Desvio Padrão`^2) %>%
mutate("Proporção"= Variância/sum(Variância))%>%
mutate("Acumulada"=cumsum(Proporção)) %>%
select(-"Desvio Padrão")
# Screeplot
var_tab2<-tab2$Variância
plot(var_tab2, lty=1, type="l",xlab = "Fator", ylab = "Variância",
pch=19, col="blue",xlim = c(1,8), lwd=2, bty="l")
abline(h = 1, col = "black", lty=2)
points(var_tab2,pch=18, cex=1.5)
dev.copy(pdf,"Figuras/screeplot.pdf")
dev.off()
# Rotação
PCAvarimax<-principal(df, nfactors=3,
n.obs=92,rotate="varimax",scores=TRUE)
# Comunalidades
tab<-rotate_df(data.frame(PCAvarimax[["communality"]]), rn = c("Variável"))
tab[1]<-"Comunalidade"
# Diagrama
fa.diagram(PCAvarimax, main = "")
dev.copy(pdf,"Figuras/componentes.pdf")
dev.off()
bartlett<-factor.scores(df,PCAvarimax,
method = c("Bartlett"))
prev<-data.frame(bartlett[["scores"]])
# Exportando os resultados
write.table(prev,file='data/base_fatorial.csv',sep=';',na="",
quote=TRUE, row.names=TRUE, col.names = TRUE )
# Saídas Latex
print(xtable(tab1, caption = "Teste de Kaiser-Meyer-Olkin",
label = "tab1"),
caption.placement = "top",
include.rownames = FALSE,
format.args = list(big.mark = ".", decimal.mark = ","))
print(xtable(tab2, caption = "Sumário do Total de Variância Explicada",
label = "tab2", digits =3 ),
caption.placement = "top",
include.rownames = TRUE,
format.args = list(big.mark = ".", decimal.mark = ","))
print(xtable(tab, caption = "Comunalidades",
label = "tab", digits =2 ),
caption.placement = "top",
include.rownames = FALSE,
format.args = list(big.mark = ".", decimal.mark = ","))
kmo$ImCov
kmo$Image
0,344918447^2
0.344918447^2
kmo$Call
