cortest.bartlett(df)
# KMO
kmo<-KMO(df)
tab_kmo<-kmo$MSAi
tab1<-rotate_df(data.frame(tab_kmo), rn = c("Variável"))
tab1[1]<-"KMO"
# Variância Explicada
tab2<-summary(princomp(df,cor=TRUE))
df_tab2<-data.frame(tab2[["sdev"]],
row.names = c("Fator 1", "Fator 2", "Fator 3", "Fator 4", "Fator 5",
"Fator 6", "Fator 7", "Fator 8", "Fator 9", "Fator 10",
"Fator 11"))
colnames(df_tab2)<-c("Desvio Padrão")
df_tab2<-df_tab2 %>%
mutate("Variância"=`Desvio Padrão`^2) %>%
mutate("Proporção"= Variância/sum(Variância)) %>%
mutate("Acumulada"=cumsum(Proporção))
View(df_tab2)
tab2
View(df_tab2)
# Carregando pacotes a serem utilizados
library(dplyr)
library(corrplot)
library(psych)
library(xtable)
library(sjmisc) #Rotação data frame
# Limpar----
rm(list=ls())
#Diretório
setwd("c:/Users/CAIO AZEVEDO/Documents/Documentos Caio/Github/Monografia")
# Importando os dados disponíveis no GitHub
site<-"https://raw.githubusercontent.com/caio-azevedo/Monografia/master/data/base.csv"
dados<- read.table(site, header=T, sep=";")
# Preparação dos dados
dados<-dados %>%
select(Municipio,x1, x2, x5, x7, x8, x9, x13, x15, x16, x17, x18)
df<-as.matrix(dados[,2:12])
row.names(df)<-dados$Municipio
df<-scale(df)
# Matriz de correlação
matcor<-cor(df)
corrplot(matcor, method="circle")
dev.copy(pdf,"Figuras/matriz_cor.pdf")
dev.off()
# Teste de Bartlett
cortest.bartlett(df)
# KMO
kmo<-KMO(df)
tab_kmo<-kmo$MSAi
tab1<-rotate_df(data.frame(tab_kmo), rn = c("Variável"))
tab1[1]<-"KMO"
# Variância Explicada
tab2<-summary(princomp(df,cor=TRUE))
df_tab2<-data.frame(tab2[["sdev"]],
row.names = c("Fator 1", "Fator 2", "Fator 3", "Fator 4", "Fator 5",
"Fator 6", "Fator 7", "Fator 8", "Fator 9", "Fator 10",
"Fator 11"))
colnames(df_tab2)<-c("Desvio Padrão")
df_tab2<-df_tab2 %>%
mutate("Variância"=`Desvio Padrão`^2) %>%
mutate("Proporção"= Variância/sum(Variância)) %>%
mutate("Acumulada"=cumsum(Proporção)) %>%
select(-"Desvio Padrão")
View(df_tab2)
tab2<-rotate_df(df_tab2)
View(tab2)
# Carregando pacotes a serem utilizados
library(dplyr)
library(corrplot)
library(psych)
library(xtable)
library(sjmisc) #Rotação data frame
# Limpar----
rm(list=ls())
#Diretório
setwd("c:/Users/CAIO AZEVEDO/Documents/Documentos Caio/Github/Monografia")
# Importando os dados disponíveis no GitHub
site<-"https://raw.githubusercontent.com/caio-azevedo/Monografia/master/data/base.csv"
dados<- read.table(site, header=T, sep=";")
# Preparação dos dados
dados<-dados %>%
select(Municipio,x1, x2, x5, x7, x8, x9, x13, x15, x16, x17, x18)
df<-as.matrix(dados[,2:12])
row.names(df)<-dados$Municipio
df<-scale(df)
# Matriz de correlação
matcor<-cor(df)
corrplot(matcor, method="circle")
dev.copy(pdf,"Figuras/matriz_cor.pdf")
dev.off()
# Teste de Bartlett
cortest.bartlett(df)
# KMO
kmo<-KMO(df)
tab_kmo<-kmo$MSAi
tab1<-rotate_df(data.frame(tab_kmo), rn = c("Variável"))
tab1[1]<-"KMO"
# Variância Explicada
tab2<-summary(princomp(df,cor=TRUE))
df_tab2<-data.frame(tab2[["sdev"]],
row.names = c(1:11))
colnames(df_tab2)<-c("Desvio Padrão")
df_tab2<-df_tab2 %>%
mutate("Variância"=`Desvio Padrão`^2) %>%
mutate("Proporção"= Variância/sum(Variância)) %>%
mutate("Acumulada"=cumsum(Proporção)) %>%
select(-"Desvio Padrão")
View(df_tab2)
tab2<-rotate_df(df_tab2)
View(tab2)
print(xtable(tab2, caption = "Sumário do Total de Variância Explicada",
label = "tab2"),
caption.placement = "top", align = "c",
include.rownames = FALSE,
format.args = list(big.mark = ".", decimal.mark = ","))
print(xtable(tab2, caption = "Sumário do Total de Variância Explicada",
label = "tab2"),
caption.placement = "top",
include.rownames = TRUE,
format.args = list(big.mark = ".", decimal.mark = ","))
print(xtable(df_tab2, caption = "Sumário do Total de Variância Explicada",
label = "tab2"),
caption.placement = "top",
include.rownames = TRUE,
format.args = list(big.mark = ".", decimal.mark = ","))
# Carregando pacotes a serem utilizados
library(dplyr)
library(corrplot)
library(psych)
library(xtable)
library(sjmisc) #Rotação data frame
# Limpar----
rm(list=ls())
#Diretório
setwd("c:/Users/CAIO AZEVEDO/Documents/Documentos Caio/Github/Monografia")
# Importando os dados disponíveis no GitHub
site<-"https://raw.githubusercontent.com/caio-azevedo/Monografia/master/data/base.csv"
dados<- read.table(site, header=T, sep=";")
# Preparação dos dados
dados<-dados %>%
select(Municipio,x1, x2, x5, x7, x8, x9, x13, x15, x16, x17, x18)
df<-as.matrix(dados[,2:12])
row.names(df)<-dados$Municipio
df<-scale(df)
# Matriz de correlação
matcor<-cor(df)
corrplot(matcor, method="circle")
dev.copy(pdf,"Figuras/matriz_cor.pdf")
dev.off()
# Teste de Bartlett
cortest.bartlett(df)
# KMO
kmo<-KMO(df)
tab_kmo<-kmo$MSAi
tab1<-rotate_df(data.frame(tab_kmo), rn = c("Variável"))
tab1[1]<-"KMO"
# Variância Explicada
tab2<-summary(princomp(df,cor=TRUE))
df_tab2<-data.frame(tab2[["sdev"]],
row.names = c(1:11))
colnames(df_tab2)<-c("Desvio Padrão")
df_tab2<-df_tab2 %>%
mutate("Variância"=`Desvio Padrão`^2) %>%
mutate("Proporção"= round(Variância/sum(Variância),4)) %>%
mutate("Acumulada"=cumsum(Proporção)) %>%
select(-"Desvio Padrão")
print(xtable(df_tab2, caption = "Sumário do Total de Variância Explicada",
label = "tab2"),
caption.placement = "top",
include.rownames = TRUE,
format.args = list(big.mark = ".", decimal.mark = ","))
View(df_tab2)
print(xtable(df_tab2, caption = "Sumário do Total de Variância Explicada",
label = "tab2"),
caption.placement = "top",
include.rownames = TRUE, digit(2,4,4),
format.args = list(big.mark = ".", decimal.mark = ","))
print(xtable(df_tab2, caption = "Sumário do Total de Variância Explicada",
label = "tab2"),
caption.placement = "top",
include.rownames = TRUE, digits(2,4,4),
format.args = list(big.mark = ".", decimal.mark = ","))
print(xtable(df_tab2, caption = "Sumário do Total de Variância Explicada",
label = "tab2"),
caption.placement = "top",
include.rownames = TRUE, digits=c(2,4,4),
format.args = list(big.mark = ".", decimal.mark = ","))
print(xtable(df_tab2, caption = "Sumário do Total de Variância Explicada",
label = "tab2"),
caption.placement = "top",
include.rownames = TRUE, digits=4,
format.args = list(big.mark = ".", decimal.mark = ","))
# Carregando pacotes a serem utilizados
library(dplyr)
library(corrplot)
library(psych)
library(xtable)
library(sjmisc) #Rotação data frame
# Limpar----
rm(list=ls())
#Diretório
setwd("c:/Users/CAIO AZEVEDO/Documents/Documentos Caio/Github/Monografia")
# Importando os dados disponíveis no GitHub
site<-"https://raw.githubusercontent.com/caio-azevedo/Monografia/master/data/base.csv"
dados<- read.table(site, header=T, sep=";")
# Preparação dos dados
dados<-dados %>%
select(Municipio,x1, x2, x5, x7, x8, x9, x13, x15, x16, x17, x18)
df<-as.matrix(dados[,2:12])
row.names(df)<-dados$Municipio
df<-scale(df)
# Matriz de correlação
matcor<-cor(df)
corrplot(matcor, method="circle")
dev.copy(pdf,"Figuras/matriz_cor.pdf")
dev.off()
# Teste de Bartlett
cortest.bartlett(df)
# KMO
kmo<-KMO(df)
tab_kmo<-kmo$MSAi
tab1<-rotate_df(data.frame(tab_kmo), rn = c("Variável"))
tab1[1]<-"KMO"
# Variância Explicada
tab2<-summary(princomp(df,cor=TRUE))
df_tab2<-data.frame(tab2[["sdev"]],
row.names = c(1:11))
colnames(df_tab2)<-c("Desvio Padrão")
df_tab2<-df_tab2 %>%
mutate("Variância"=`Desvio Padrão`^2) %>%
mutate("Proporção"= Variância/sum(Variância))%>%
mutate("Acumulada"=cumsum(Proporção)) %>%
select(-"Desvio Padrão")
View(df_tab2)
# Carregando pacotes a serem utilizados
library(dplyr)
library(corrplot)
library(psych)
library(xtable)
library(sjmisc) #Rotação data frame
# Limpar----
rm(list=ls())
#Diretório
setwd("c:/Users/CAIO AZEVEDO/Documents/Documentos Caio/Github/Monografia")
# Importando os dados disponíveis no GitHub
site<-"https://raw.githubusercontent.com/caio-azevedo/Monografia/master/data/base.csv"
dados<- read.table(site, header=T, sep=";")
# Preparação dos dados
dados<-dados %>%
select(Municipio,x1, x2, x5, x7, x8, x9, x13, x15, x16, x17, x18)
df<-as.matrix(dados[,2:12])
row.names(df)<-dados$Municipio
df<-scale(df)
# Matriz de correlação
matcor<-cor(df)
corrplot(matcor, method="circle")
dev.copy(pdf,"Figuras/matriz_cor.pdf")
dev.off()
# Teste de Bartlett
cortest.bartlett(df)
# KMO
kmo<-KMO(df)
tab_kmo<-kmo$MSAi
tab1<-rotate_df(data.frame(tab_kmo), rn = c("Variável"))
tab1[1]<-"KMO"
# Variância Explicada
tab2<-summary(princomp(df,cor=TRUE))
df_tab2<-data.frame(tab2[["sdev"]],
row.names = c(1:11))
colnames(df_tab2)<-c("Desvio Padrão")
df_tab2<-df_tab2 %>%
mutate("Variância"=round(`Desvio Padrão`^2,4)) %>%
mutate("Proporção"= Variância/sum(Variância))%>%
mutate("Acumulada"=cumsum(Proporção)) %>%
select(-"Desvio Padrão")
View(df_tab2)
print(xtable(df_tab2, caption = "Sumário do Total de Variância Explicada",
label = "tab2"),
caption.placement = "top",
include.rownames = TRUE,
format.args = list(big.mark = ".", decimal.mark = ","))
print(xtable(df_tab2, caption = "Sumário do Total de Variância Explicada",
label = "tab2", digits = 4),
caption.placement = "top",
include.rownames = TRUE,
format.args = list(big.mark = ".", decimal.mark = ","))
print(xtable(df_tab2, caption = "Sumário do Total de Variância Explicada",
label = "tab2", digits = c(4,2,2)),
caption.placement = "top",
include.rownames = TRUE,
format.args = list(big.mark = ".", decimal.mark = ","))
# Carregando pacotes a serem utilizados
library(dplyr)
library(corrplot)
library(psych)
library(xtable)
library(sjmisc) #Rotação data frame
# Limpar----
rm(list=ls())
#Diretório
setwd("c:/Users/CAIO AZEVEDO/Documents/Documentos Caio/Github/Monografia")
# Importando os dados disponíveis no GitHub
site<-"https://raw.githubusercontent.com/caio-azevedo/Monografia/master/data/base.csv"
dados<- read.table(site, header=T, sep=";")
# Preparação dos dados
dados<-dados %>%
select(Municipio,x1, x2, x5, x7, x8, x9, x13, x15, x16, x17, x18)
df<-as.matrix(dados[,2:12])
row.names(df)<-dados$Municipio
df<-scale(df)
# Matriz de correlação
matcor<-cor(df)
corrplot(matcor, method="circle")
dev.copy(pdf,"Figuras/matriz_cor.pdf")
dev.off()
# Teste de Bartlett
cortest.bartlett(df)
# KMO
kmo<-KMO(df)
tab_kmo<-kmo$MSAi
tab1<-rotate_df(data.frame(tab_kmo), rn = c("Variável"))
tab1[1]<-"KMO"
# Variância Explicada
tab2<-summary(princomp(df,cor=TRUE))
df_tab2<-data.frame(tab2[["sdev"]],
row.names = c(1:11))
colnames(df_tab2)<-c("Desvio Padrão")
df_tab2<-df_tab2 %>%
mutate("Variância"=round(`Desvio Padrão`^2,4)) %>%
mutate("Proporção"= Variância/sum(Variância))%>%
mutate("Acumulada"=cumsum(Proporção)) %>%
select(-"Desvio Padrão")
tab2<-rotate_df(df_tab2)
# Screeplot
var_tab2<-df_tab2$Variância
df_tab2
plot(var_tab2, lty=1, type="l",xlab = "Fator", ylab = "Variância",
pch=19, col="blue",xlim = c(1,8), lwd=2, bty="l")
abline(h = 1, col = "black", lty=2)
points(var_tab2,pch=18, cex=1.5)
dev.copy(pdf,"Figuras/screeplot.pdf")
dev.off()
# Rotação
PCAvarimax<-principal(df, nfactors=3,
n.obs=92,rotate="varimax",scores=TRUE)
PCAvarimax$loadings
# Diagrama
fa.diagram(PCAvarimax, main = "")
dev.copy(pdf,"Figuras/componentes.pdf")
dev.off()
bartlett<-factor.scores(df,PCAvarimax,
method = c("Bartlett"))
prev<-data.frame(bartlett[["scores"]])
# Exportando os resultados
write.table(prev,file='data/base_fatorial.csv',sep=';',na="",
quote=TRUE, row.names=TRUE, col.names = TRUE )
# Saídas Latex
print(xtable(tab1, caption = "Teste de Kaiser-Meyer-Olkin",
label = "tab1"),
caption.placement = "top",
include.rownames = FALSE,
format.args = list(big.mark = ".", decimal.mark = ","))
print(xtable(df_tab2, caption = "Sumário do Total de Variância Explicada",
label = "tab2", digits = 4),
caption.placement = "top",
include.rownames = TRUE,
format.args = list(big.mark = ".", decimal.mark = ","))
print(xtable(df_tab2, caption = "Sumário do Total de Variância Explicada",
label = "tab2", digits = NULL),
caption.placement = "top",
include.rownames = TRUE,
format.args = list(big.mark = ".", decimal.mark = ","))
print(xtable(df_tab2, caption = "Sumário do Total de Variância Explicada",
label = "tab2", digits = ),
caption.placement = "top",
include.rownames = TRUE,
format.args = list(big.mark = ".", decimal.mark = ","))
print(xtable(df_tab2, caption = "Sumário do Total de Variância Explicada",
label = "tab2", digits =3 ),
caption.placement = "top",
include.rownames = TRUE,
format.args = list(big.mark = ".", decimal.mark = ","))
# Carregando pacotes a serem utilizados
library(dplyr)
library(corrplot)
library(psych)
library(xtable)
library(sjmisc) #Rotação data frame
# Limpar----
rm(list=ls())
#Diretório
setwd("c:/Users/CAIO AZEVEDO/Documents/Documentos Caio/Github/Monografia")
# Importando os dados disponíveis no GitHub
site<-"https://raw.githubusercontent.com/caio-azevedo/Monografia/master/data/base.csv"
dados<- read.table(site, header=T, sep=";")
# Preparação dos dados
dados<-dados %>%
select(Municipio,x1, x2, x5, x7, x8, x9, x13, x15, x16, x17, x18)
df<-as.matrix(dados[,2:12])
row.names(df)<-dados$Municipio
df<-scale(df)
# Matriz de correlação
matcor<-cor(df)
corrplot(matcor, method="circle")
dev.copy(pdf,"Figuras/matriz_cor.pdf")
dev.off()
# Teste de Bartlett
cortest.bartlett(df)
# KMO
kmo<-KMO(df)
tab_kmo<-kmo$MSAi
tab1<-rotate_df(data.frame(tab_kmo), rn = c("Variável"))
tab1[1]<-"KMO"
# Variância Explicada
tab2<-summary(princomp(df,cor=TRUE))
tab2<-data.frame(tab2[["sdev"]],
row.names = c(1:11))
colnames(tab2)<-c("Desvio Padrão")
tab2<-tab2 %>%
mutate("Variância"=round(`Desvio Padrão`^2,4)) %>%
mutate("Proporção"= Variância/sum(Variância))%>%
mutate("Acumulada"=cumsum(Proporção)) %>%
select(-"Desvio Padrão")
# Carregando pacotes a serem utilizados
library(dplyr)
library(corrplot)
library(psych)
library(xtable)
library(sjmisc) #Rotação data frame
# Limpar----
rm(list=ls())
#Diretório
setwd("c:/Users/CAIO AZEVEDO/Documents/Documentos Caio/Github/Monografia")
# Importando os dados disponíveis no GitHub
site<-"https://raw.githubusercontent.com/caio-azevedo/Monografia/master/data/base.csv"
dados<- read.table(site, header=T, sep=";")
# Preparação dos dados
dados<-dados %>%
select(Municipio,x1, x2, x5, x7, x8, x9, x13, x15, x16, x17, x18)
df<-as.matrix(dados[,2:12])
row.names(df)<-dados$Municipio
df<-scale(df)
# Matriz de correlação
matcor<-cor(df)
corrplot(matcor, method="circle")
dev.copy(pdf,"Figuras/matriz_cor.pdf")
dev.off()
# Teste de Bartlett
cortest.bartlett(df)
kmo<-KMO(df)
tab_kmo<-kmo$MSAi
tab1<-rotate_df(data.frame(tab_kmo), rn = c("Variável"))
tab1[1]<-"KMO"
View(kmo)
View(tab1)
mean(tab1)
mean(tab_kmo)
tab2<-summary(princomp(df,cor=TRUE))
tab2<-data.frame(tab2[["sdev"]],
row.names = c(1:11))
colnames(tab2)<-c("Desvio Padrão")
tab2<-tab2 %>%
mutate("Variância"=`Desvio Padrão`^2) %>%
mutate("Proporção"= Variância/sum(Variância))%>%
mutate("Acumulada"=cumsum(Proporção)) %>%
select(-"Desvio Padrão")
# Screeplot
var_tab2<-tab2$Variância
plot(var_tab2, lty=1, type="l",xlab = "Fator", ylab = "Variância",
pch=19, col="blue",xlim = c(1,8), lwd=2, bty="l")
abline(h = 1, col = "black", lty=2)
points(var_tab2,pch=18, cex=1.5)
dev.copy(pdf,"Figuras/screeplot.pdf")
dev.off()
PCAvarimax<-principal(df, nfactors=3,
n.obs=92,rotate="varimax",scores=TRUE)
PCAvarimax$loadings
tab3<-data.frame(PCAvarimax$loadings)
View(PCAvarimax)
PCAvarimax[["communality"]]
# Comunalidades
tab<-data.frame(PCAvarimax[["communality"]])
View(tab)
rm(tab)
tab<-rotate_df(data.frame(PCAvarimax[["communality"]]), rn = c("Variável"))
View(tab)
tab[1]<-"Comunalidade"
View(tab)
print(xtable(tab, caption = "Comunalidades",
label = "tab", digits =3 ),
caption.placement = "top",
include.rownames = TRUE,
format.args = list(big.mark = ".", decimal.mark = ","))
print(xtable(tab, caption = "Comunalidades",
label = "tab", digits =2 ),
caption.placement = "top",
include.rownames = FALSE,
format.args = list(big.mark = ".", decimal.mark = ","))
tab3<-data.frame(PCAvarimax$loadings)
PCAvarimax[["loadings"]]
PCAvarimax[["weights"]]
PCAvarimax[["Structure"]]
PCAvarimax[["Structure"]]
tab3<-data.frame(PCAvarimax[["loadings"]])
View(tab1)
View(tab2)
c<-tab2$Variância/tab2$Proporção
c
5,27477290/0,479524809
5.27477290/0.479524809
1.80540158/0.164127417
View(df)
